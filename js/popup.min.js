var tabs={};$(document.body).on("hover","#tablist",function(){$(this).toggleClass("active");}).on("click","#displayModal",function(){$("#myModal").modal("show");$(".modal-body").empty();var c=$(this).attr("value");var b=Object.keys(tabs[c].data).length;$(".modal-body").append('<table class="table table-condenced"><tbody id="tabcontent"></tbody></table>');for(var a=0;a<b;a++){$("#tabcontent").append('<tr><td><img class="favicon" src="'+tabs[c].data[a].favIconUrl+'"/></td><td><small>'+tabs[c].data[a].title+"</small></td></tr>");}}).on("blue keyup paste","#editable",function(){var a=$(this).attr("name");tabs[a].th_description=$(this).html();chrome.storage.local.set({tabs:tabs},function(){console.log(a+" saved");});}).on("click","#closeWindow",function(){window.close();}).on("click","button",function(){var a=$(this).attr("value");if($(this).attr("name")=="remove"){removeFromHistory(a);}else{if($(this).attr("name")=="restore"){restoreTabs(a);}}});$("#saveButton").click(function(){saveCurrentTabs();});$("#closeTabs").click(function(){chrome.runtime.sendMessage({closeTabs:true});});$("#myModal").on("hidden.bs.modal",function(){$(this).removeData("bs.modal");});len=function(c){var b=0;for(var a in c){++b;}return b;};saveCurrentTabs=function(){var b={};var a=moment().format("l hh:mm:ss A");chrome.tabs.query({},function(c){for(var d=0;d<c.length;d++){b[d]={title:c[d].title,url:c[d].url,favIconUrl:c[d].favIconUrl};}tabs[a]={data:b,th_description:"*click to edit"};chrome.storage.local.set({tabs:tabs},function(){console.log(a+" saved");});displaySavedTabs();});};displaySavedTabs=function(){var b=Object.keys(tabs);$("#tabview").empty();for(var a=b.length-1;a>=0;a--){$("#tabview").append("<tr id='tablist'><td id='editable' contenteditable='true' name='"+b[a]+"'>"+tabs[b[a]].th_description+"</td><td class='tabname'>"+b[a]+"</td><td><div class='btn-group btn-group-xs'><button data-toggle='modal' data-target='myModal' value='"+b[a]+"' id='displayModal' class='btn btn-default btn-xs' name='preview'><span class='glyphicon glyphicon-eye-open'> Preview</span></button><button type='button' class='btn btn-default btn-xs' name='restore' value='"+b[a]+"'><span class='glyphicon glyphicon-folder-open'> Restore</span></button><button type='button' class='btn btn-danger btn-xs' name='remove' value='"+b[a]+"'><span class='glyphicon glyphicon-trash'> Delete</span></button></div></td></tr>");}};loadTabHistory=function(){chrome.storage.local.get("tabs",function(a){if(a.tabs){tabs=a.tabs;}displaySavedTabs();});};restoreTabs=function(a){chrome.runtime.sendMessage({restoreTabs:true,tabs:tabs,key:a});};removeFromHistory=function(a){delete tabs[a];chrome.storage.local.set({tabs:tabs},function(){console.log("saved tabs");});displaySavedTabs();};initialize=function(){loadTabHistory();};initialize();